
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\project\RIDE\obj\ymodem.o:     file format elf32-littlearm
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\project\RIDE\obj\ymodem.o

Disassembly of section .text.Receive_Byte:

00000000 <Receive_Byte>:
Receive_Byte():
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:54
  * @param  timeout: Timeout
  * @retval 0: Byte received
  *         -1: Timeout
  */
static  int32_t Receive_Byte (uint8_t *c, uint32_t timeout)
{
   0:	b570      	push	{r4, r5, r6, lr}
   2:	4605      	mov	r5, r0
   4:	460c      	mov	r4, r1
   6:	e007      	b.n	18 <Receive_Byte+0x18>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:57
  while (timeout-- > 0)
  {
    if (SerialKeyPressed(c) == 1)
   8:	4628      	mov	r0, r5
   a:	f7ff fffe 	bl	0 <SerialKeyPressed>
   e:	3c01      	subs	r4, #1
  10:	2801      	cmp	r0, #1
  12:	d101      	bne.n	18 <SerialKeyPressed+0x18>
  14:	3801      	subs	r0, #1
  16:	e003      	b.n	20 <SerialKeyPressed+0x20>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:55
  * @retval 0: Byte received
  *         -1: Timeout
  */
static  int32_t Receive_Byte (uint8_t *c, uint32_t timeout)
{
  while (timeout-- > 0)
  18:	2c00      	cmp	r4, #0
  1a:	d1f5      	bne.n	8 <SerialKeyPressed+0x8>
  1c:	f04f 30ff 	mov.w	r0, #4294967295	; 0xffffffff
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:63
    {
      return 0;
    }
  }
  return -1;
}
  20:	bd70      	pop	{r4, r5, r6, pc}
  22:	46c0      	nop			(mov r8, r8)
Disassembly of section .text.Send_Byte:

00000000 <Send_Byte>:
Send_Byte():
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:71
  * @brief  Send a byte
  * @param  c: Character
  * @retval 0: Byte sent
  */
static uint32_t Send_Byte (uint8_t c)
{
   0:	b510      	push	{r4, lr}
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:72
  SerialPutChar(c);
   2:	f7ff fffe 	bl	0 <SerialPutChar>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:74
  return 0;
}
   6:	2000      	movs	r0, #0
   8:	bd10      	pop	{r4, pc}
   a:	46c0      	nop			(mov r8, r8)
Disassembly of section .text.Ymodem_Receive:

00000000 <Ymodem_Receive>:
Ymodem_Receive():
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:145
  * @brief  Receive a file using the ymodem protocol
  * @param  buf: Address of the first byte
  * @retval The size of the file
  */
int32_t Ymodem_Receive (uint8_t *buf)
{
   0:	e92d 47f0 	stmdb	sp!, {r4, r5, r6, r7, r8, r9, sl, lr}
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:150
  uint8_t packet_data[PACKET_1K_SIZE + PACKET_OVERHEAD], file_size[FILE_SIZE_LENGTH], *file_ptr, *buf_ptr;
  int32_t i, j, packet_length, session_done, file_done, packets_received, errors, session_begin, size = 0;

  /* Initialize FlashDestination variable */
  FlashDestination = ApplicationAddress;
   4:	4a94      	ldr	r2, [pc, #592]	(258 <Ymodem_Receive+0x258>)
   6:	4b95      	ldr	r3, [pc, #596]	(25c <Ymodem_Receive+0x25c>)
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:147
  * @retval The size of the file
  */
int32_t Ymodem_Receive (uint8_t *buf)
{
  uint8_t packet_data[PACKET_1K_SIZE + PACKET_OVERHEAD], file_size[FILE_SIZE_LENGTH], *file_ptr, *buf_ptr;
  int32_t i, j, packet_length, session_done, file_done, packets_received, errors, session_begin, size = 0;
   8:	2100      	movs	r1, #0
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:145
  * @brief  Receive a file using the ymodem protocol
  * @param  buf: Address of the first byte
  * @retval The size of the file
  */
int32_t Ymodem_Receive (uint8_t *buf)
{
   a:	f5ad 6d84 	sub.w	sp, sp, #1056	; 0x420
   e:	4682      	mov	sl, r0
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:147
  uint8_t packet_data[PACKET_1K_SIZE + PACKET_OVERHEAD], file_size[FILE_SIZE_LENGTH], *file_ptr, *buf_ptr;
  int32_t i, j, packet_length, session_done, file_done, packets_received, errors, session_begin, size = 0;
  10:	f8cd 1418 	str.w	r1, [sp, #1048]
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:150

  /* Initialize FlashDestination variable */
  FlashDestination = ApplicationAddress;
  14:	601a      	str	r2, [r3, #0]
  16:	4688      	mov	r8, r1
  18:	460d      	mov	r5, r1
  1a:	4689      	mov	r9, r1
Receive_Packet():
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:93
static int32_t Receive_Packet (uint8_t *data, int32_t *length, uint32_t timeout)
{
  uint16_t i, packet_size;
  uint8_t c;
  *length = 0;
  if (Receive_Byte(&c, timeout) != 0)
  1c:	f50d 6482 	add.w	r4, sp, #1040	; 0x410
  20:	340f      	adds	r4, #15
  22:	4620      	mov	r0, r4
  24:	f44f 1180 	mov.w	r1, #1048576	; 0x100000
  28:	f7ff fffe 	bl	0 <Ymodem_Receive>
  2c:	2800      	cmp	r0, #0
  2e:	f040 810f 	bne.w	250 <Ymodem_Receive+0x250>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:97
  {
    return -1;
  }
  switch (c)
  32:	f89d 241f 	ldrb.w	r2, [sp, #1055]
  36:	2a04      	cmp	r2, #4
  38:	d040      	beq.n	bc <Ymodem_Receive+0xbc>
  3a:	d805      	bhi.n	48 <Ymodem_Receive+0x48>
  3c:	2a01      	cmp	r2, #1
  3e:	d01e      	beq.n	7e <Ymodem_Receive+0x7e>
  40:	2a02      	cmp	r2, #2
  42:	f040 8105 	bne.w	250 <Ymodem_Receive+0x250>
  46:	e009      	b.n	5c <Ymodem_Receive+0x5c>
  48:	2a41      	cmp	r2, #65
  4a:	f000 80e5 	beq.w	218 <Ymodem_Receive+0x218>
  4e:	2a61      	cmp	r2, #97
  50:	f000 80e2 	beq.w	218 <Ymodem_Receive+0x218>
  54:	2a18      	cmp	r2, #24
  56:	f040 80fb 	bne.w	250 <Ymodem_Receive+0x250>
  5a:	e002      	b.n	62 <Ymodem_Receive+0x62>
  5c:	f44f 6680 	mov.w	r6, #1024	; 0x400
  60:	e00e      	b.n	80 <Ymodem_Receive+0x80>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:108
      packet_size = PACKET_1K_SIZE;
      break;
    case EOT:
      return 0;
    case CA:
      if ((Receive_Byte(&c, timeout) == 0) && (c == CA))
  62:	4620      	mov	r0, r4
  64:	f44f 1180 	mov.w	r1, #1048576	; 0x100000
  68:	f7ff fffe 	bl	0 <Ymodem_Receive>
  6c:	2800      	cmp	r0, #0
  6e:	f040 80ef 	bne.w	250 <Ymodem_Receive+0x250>
  72:	f89d 341f 	ldrb.w	r3, [sp, #1055]
  76:	2b18      	cmp	r3, #24
  78:	f040 80ea 	bne.w	250 <Ymodem_Receive+0x250>
  7c:	e022      	b.n	c4 <Ymodem_Receive+0xc4>
  7e:	2680      	movs	r6, #128
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:123
    case ABORT2:
      return 1;
    default:
      return -1;
  }
  *data = c;
  80:	ab04      	add	r3, sp, #16
  82:	3b0d      	subs	r3, #13
  84:	701a      	strb	r2, [r3, #0]
  86:	2401      	movs	r4, #1
  88:	e009      	b.n	9e <Ymodem_Receive+0x9e>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:126
  for (i = 1; i < (packet_size + PACKET_OVERHEAD); i ++)
  {
    if (Receive_Byte(data + i, timeout) != 0)
  8a:	1908      	adds	r0, r1, r4
  8c:	f44f 1180 	mov.w	r1, #1048576	; 0x100000
  90:	f7ff fffe 	bl	0 <Ymodem_Receive>
  94:	2800      	cmp	r0, #0
  96:	f040 80db 	bne.w	250 <Ymodem_Receive+0x250>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:124
      return 1;
    default:
      return -1;
  }
  *data = c;
  for (i = 1; i < (packet_size + PACKET_OVERHEAD); i ++)
  9a:	1c63      	adds	r3, r4, #1
  9c:	b29c      	uxth	r4, r3
  9e:	1d33      	adds	r3, r6, #4
  a0:	a904      	add	r1, sp, #16
  a2:	42a3      	cmp	r3, r4
  a4:	4637      	mov	r7, r6
  a6:	f1a1 010d 	sub.w	r1, r1, #13	; 0xd
  aa:	daee      	bge.n	8a <Ymodem_Receive+0x8a>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:131
    if (Receive_Byte(data + i, timeout) != 0)
    {
      return -1;
    }
  }
  if (data[PACKET_SEQNO_INDEX] != ((data[PACKET_SEQNO_COMP_INDEX] ^ 0xff) & 0xff))
  ac:	788b      	ldrb	r3, [r1, #2]
  ae:	784a      	ldrb	r2, [r1, #1]
  b0:	43db      	mvns	r3, r3
  b2:	b2db      	uxtb	r3, r3
  b4:	429a      	cmp	r2, r3
  b6:	f040 80cb 	bne.w	250 <Ymodem_Receive+0x250>
  ba:	e001      	b.n	c0 <Ymodem_Receive+0xc0>
  bc:	4607      	mov	r7, r0
  be:	e003      	b.n	c8 <Ymodem_Receive+0xc8>
Ymodem_Receive():
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:160
    {
      switch (Receive_Packet(packet_data, &packet_length, NAK_TIMEOUT))
      {
        case 0:
          errors = 0;
          switch (packet_length)
  c0:	b116      	cbz	r6, c8 <Ymodem_Receive+0xc8>
  c2:	e007      	b.n	d4 <Ymodem_Receive+0xd4>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:164
          {
              /* Abort by sender */
            case - 1:
              Send_Byte(ACK);
  c4:	2006      	movs	r0, #6
  c6:	e0b7      	b.n	238 <Ymodem_Receive+0x238>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:168
              return 0;
              /* End of transmission */
            case 0:
              Send_Byte(ACK);
  c8:	2006      	movs	r0, #6
  ca:	f7ff fffe 	bl	0 <Ymodem_Receive>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:150
{
  uint8_t packet_data[PACKET_1K_SIZE + PACKET_OVERHEAD], file_size[FILE_SIZE_LENGTH], *file_ptr, *buf_ptr;
  int32_t i, j, packet_length, session_done, file_done, packets_received, errors, session_begin, size = 0;

  /* Initialize FlashDestination variable */
  FlashDestination = ApplicationAddress;
  ce:	46b8      	mov	r8, r7
  d0:	463d      	mov	r5, r7
  d2:	e7a3      	b.n	1c <Ymodem_Receive+0x1c>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:173
              Send_Byte(ACK);
              file_done = 1;
              break;
              /* Normal packet */
            default:
              if ((packet_data[PACKET_SEQNO_INDEX] & 0xff) != (packets_received & 0xff))
  d4:	f008 03ff 	and.w	r3, r8, #255	; 0xff
  d8:	429a      	cmp	r2, r3
  da:	d004      	beq.n	e6 <Ymodem_Receive+0xe6>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:175
              {
                Send_Byte(NAK);
  dc:	2015      	movs	r0, #21
  de:	f7ff fffe 	bl	0 <Ymodem_Receive>
  e2:	2500      	movs	r5, #0
  e4:	e79a      	b.n	1c <Ymodem_Receive+0x1c>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:179
              }
              else
              {
                if (packets_received == 0)
  e6:	f1b8 0f00 	cmp.w	r8, #0	; 0x0
  ea:	d15d      	bne.n	1a8 <Ymodem_Receive+0x1a8>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:181
                {/* Filename packet */
                  if (packet_data[PACKET_HEADER] != 0)
  ec:	78cb      	ldrb	r3, [r1, #3]
  ee:	2b00      	cmp	r3, #0
  f0:	d054      	beq.n	19c <Ymodem_Receive+0x19c>
  f2:	1cc8      	adds	r0, r1, #3
  f4:	46c6      	mov	lr, r8
  f6:	e005      	b.n	104 <Ymodem_Receive+0x104>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:185
                  {/* Filename packet has valid data */
                    for (i = 0, file_ptr = packet_data + PACKET_HEADER; (*file_ptr != 0) && (i < FILE_NAME_LENGTH);)
                    {
                      file_name[i++] = *file_ptr++;
  f8:	4b59      	ldr	r3, [pc, #356]	(260 <Ymodem_Receive+0x260>)
  fa:	3001      	adds	r0, #1
  fc:	f803 200e 	strb.w	r2, [r3, lr]
 100:	f10e 0e01 	add.w	lr, lr, #1	; 0x1
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:183
              {
                if (packets_received == 0)
                {/* Filename packet */
                  if (packet_data[PACKET_HEADER] != 0)
                  {/* Filename packet has valid data */
                    for (i = 0, file_ptr = packet_data + PACKET_HEADER; (*file_ptr != 0) && (i < FILE_NAME_LENGTH);)
 104:	7802      	ldrb	r2, [r0, #0]
 106:	b112      	cbz	r2, 10e <Ymodem_Receive+0x10e>
 108:	f5be 7f80 	cmp.w	lr, #256	; 0x100
 10c:	d1f4      	bne.n	f8 <Ymodem_Receive+0xf8>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:187
                    {
                      file_name[i++] = *file_ptr++;
                    }
                    file_name[i++] = '\0';
 10e:	4b54      	ldr	r3, [pc, #336]	(260 <Ymodem_Receive+0x260>)
 110:	2200      	movs	r2, #0
 112:	f803 200e 	strb.w	r2, [r3, lr]
 116:	e003      	b.n	120 <Ymodem_Receive+0x120>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:190
                    for (i = 0, file_ptr ++; (*file_ptr != ' ') && (i < FILE_SIZE_LENGTH);)
                    {
                      file_size[i++] = *file_ptr++;
 118:	f50d 6381 	add.w	r3, sp, #1032	; 0x408
 11c:	549c      	strb	r4, [r3, r2]
 11e:	3201      	adds	r2, #1
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:188
                    for (i = 0, file_ptr = packet_data + PACKET_HEADER; (*file_ptr != 0) && (i < FILE_NAME_LENGTH);)
                    {
                      file_name[i++] = *file_ptr++;
                    }
                    file_name[i++] = '\0';
                    for (i = 0, file_ptr ++; (*file_ptr != ' ') && (i < FILE_SIZE_LENGTH);)
 120:	1883      	adds	r3, r0, r2
 122:	785c      	ldrb	r4, [r3, #1]
 124:	2c20      	cmp	r4, #32
 126:	d001      	beq.n	12c <Ymodem_Receive+0x12c>
 128:	2a10      	cmp	r2, #16
 12a:	d1f5      	bne.n	118 <Ymodem_Receive+0x118>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:192
                    {
                      file_size[i++] = *file_ptr++;
                    }
                    file_size[i++] = '\0';
 12c:	f50d 6184 	add.w	r1, sp, #1056	; 0x420
 130:	188b      	adds	r3, r1, r2
 132:	2400      	movs	r4, #0
 134:	f803 4c18 	strb.w	r4, [r3, #-24]
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:193
                    Str2Int(file_size, &size);
 138:	f50d 6081 	add.w	r0, sp, #1032	; 0x408
 13c:	f50d 6183 	add.w	r1, sp, #1048	; 0x418
 140:	f7ff fffe 	bl	0 <Str2Int>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:196
                    /* Test the size of the image to be sent */
                    /* Image size is greater than Flash size */
                    if (size > (FLASH_SIZE - 1))
 144:	f8dd 0418 	ldr.w	r0, [sp, #1048]
 148:	f5b0 3f00 	cmp.w	r0, #131072	; 0x20000
 14c:	db08      	blt.n	160 <Ymodem_Receive+0x160>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:199
                    {
                      /* End session */
                      Send_Byte(CA);
 14e:	2018      	movs	r0, #24
 150:	f7ff fffe 	bl	0 <Ymodem_Receive>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:200
                      Send_Byte(CA);
 154:	2018      	movs	r0, #24
 156:	f7ff fffe 	bl	0 <Ymodem_Receive>
 15a:	f04f 30ff 	mov.w	r0, #4294967295	; 0xffffffff
 15e:	e073      	b.n	ea <FLASH_PagesMask+0xea>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:205
                      return -1;
                    }
                    /* Erase the needed pages where the user application will be loaded */
                    /* Define the number of page to be erased */
                    NbrOfPage = FLASH_PagesMask(size);
 160:	f7ff fffe 	bl	0 <FLASH_PagesMask>
 164:	4b3f      	ldr	r3, [pc, #252]	(264 <Ymodem_Receive+0x264>)
 166:	6018      	str	r0, [r3, #0]
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:207
                    /* Erase the FLASH pages */
                    for (EraseCounter = 0; (EraseCounter < NbrOfPage) && (FLASHStatus == FLASH_COMPLETE); EraseCounter++)
 168:	605c      	str	r4, [r3, #4]
 16a:	e009      	b.n	180 <Ymodem_Receive+0x180>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:209
                    {
                      FLASHStatus = FLASH_ErasePage(FlashDestination + (PageSize * EraseCounter));
 16c:	88a3      	ldrh	r3, [r4, #4]
 16e:	6820      	ldr	r0, [r4, #0]
 170:	fb02 0003 	mla	r0, r2, r3, r0
 174:	f7ff fffe 	bl	0 <FLASH_ErasePage>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:207
                    }
                    /* Erase the needed pages where the user application will be loaded */
                    /* Define the number of page to be erased */
                    NbrOfPage = FLASH_PagesMask(size);
                    /* Erase the FLASH pages */
                    for (EraseCounter = 0; (EraseCounter < NbrOfPage) && (FLASHStatus == FLASH_COMPLETE); EraseCounter++)
 178:	686b      	ldr	r3, [r5, #4]
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:209
                    {
                      FLASHStatus = FLASH_ErasePage(FlashDestination + (PageSize * EraseCounter));
 17a:	71a0      	strb	r0, [r4, #6]
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:207
                    }
                    /* Erase the needed pages where the user application will be loaded */
                    /* Define the number of page to be erased */
                    NbrOfPage = FLASH_PagesMask(size);
                    /* Erase the FLASH pages */
                    for (EraseCounter = 0; (EraseCounter < NbrOfPage) && (FLASHStatus == FLASH_COMPLETE); EraseCounter++)
 17c:	3301      	adds	r3, #1
 17e:	606b      	str	r3, [r5, #4]
 180:	4d38      	ldr	r5, [pc, #224]	(264 <Ymodem_Receive+0x264>)
 182:	686a      	ldr	r2, [r5, #4]
 184:	682b      	ldr	r3, [r5, #0]
 186:	429a      	cmp	r2, r3
 188:	d203      	bcs.n	192 <Ymodem_Receive+0x192>
 18a:	4c34      	ldr	r4, [pc, #208]	(25c <Ymodem_Receive+0x25c>)
 18c:	79a3      	ldrb	r3, [r4, #6]
 18e:	2b04      	cmp	r3, #4
 190:	d0ec      	beq.n	16c <Ymodem_Receive+0x16c>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:211
                    {
                      FLASHStatus = FLASH_ErasePage(FlashDestination + (PageSize * EraseCounter));
                    }
                    Send_Byte(ACK);
 192:	2006      	movs	r0, #6
 194:	f7ff fffe 	bl	0 <Ymodem_Receive>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:212
                    Send_Byte(CRC16);
 198:	2043      	movs	r0, #67
 19a:	e035      	b.n	208 <Ymodem_Receive+0x208>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:217
                  }
                  /* Filename packet is empty, end session */
                  else
                  {
                    Send_Byte(ACK);
 19c:	2006      	movs	r0, #6
 19e:	f7ff fffe 	bl	0 <Ymodem_Receive>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:277
    if (session_done != 0)
    {
      break;
    }
  }
  return (int32_t)size;
 1a2:	f8dd 0418 	ldr.w	r0, [sp, #1048]
 1a6:	e04f      	b.n	248 <Ymodem_Receive+0x248>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:226
                  }
                }
                /* Data packet */
                else
                {
                  memcpy(buf_ptr, packet_data + PACKET_HEADER, packet_length);
 1a8:	4650      	mov	r0, sl
 1aa:	3103      	adds	r1, #3
 1ac:	4632      	mov	r2, r6
 1ae:	f7ff fffe 	bl	0 <memcpy>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:227
                  RamSource = (uint32_t)buf;
 1b2:	4b2d      	ldr	r3, [pc, #180]	(268 <Ymodem_Receive+0x268>)
 1b4:	2400      	movs	r4, #0
 1b6:	f8c3 a000 	str.w	sl, [r3]
 1ba:	e018      	b.n	1ee <Ymodem_Receive+0x1ee>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:231
                  for (j = 0;(j < packet_length) && (FlashDestination <  ApplicationAddress + size);j += 4)
                  {
                    /* Program the data received into STM32F10x Flash */
                    FLASH_ProgramWord(FlashDestination, *(uint32_t*)RamSource);
 1bc:	4d2a      	ldr	r5, [pc, #168]	(268 <Ymodem_Receive+0x268>)
 1be:	682b      	ldr	r3, [r5, #0]
 1c0:	6819      	ldr	r1, [r3, #0]
 1c2:	f7ff fffe 	bl	0 <FLASH_ProgramWord>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:232
                    if (*(uint32_t*)FlashDestination != *(uint32_t*)RamSource)
 1c6:	6839      	ldr	r1, [r7, #0]
 1c8:	6828      	ldr	r0, [r5, #0]
 1ca:	680a      	ldr	r2, [r1, #0]
 1cc:	6803      	ldr	r3, [r0, #0]
 1ce:	429a      	cmp	r2, r3
 1d0:	d008      	beq.n	1e4 <Ymodem_Receive+0x1e4>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:235
                    {
                      /* End session */
                      Send_Byte(CA);
 1d2:	2018      	movs	r0, #24
 1d4:	f7ff fffe 	bl	0 <Ymodem_Receive>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:236
                      Send_Byte(CA);
 1d8:	2018      	movs	r0, #24
 1da:	f7ff fffe 	bl	0 <Ymodem_Receive>
 1de:	f06f 0001 	mvn.w	r0, #1	; 0x1
 1e2:	e031      	b.n	248 <Ymodem_Receive+0x248>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:239
                      return -2;
                    }
                    FlashDestination += 4;
 1e4:	1d0b      	adds	r3, r1, #4
 1e6:	603b      	str	r3, [r7, #0]
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:240
                    RamSource += 4;
 1e8:	1d03      	adds	r3, r0, #4
 1ea:	602b      	str	r3, [r5, #0]
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:228
                /* Data packet */
                else
                {
                  memcpy(buf_ptr, packet_data + PACKET_HEADER, packet_length);
                  RamSource = (uint32_t)buf;
                  for (j = 0;(j < packet_length) && (FlashDestination <  ApplicationAddress + size);j += 4)
 1ec:	3404      	adds	r4, #4
 1ee:	42b4      	cmp	r4, r6
 1f0:	da09      	bge.n	206 <Ymodem_Receive+0x206>
 1f2:	4f1a      	ldr	r7, [pc, #104]	(25c <Ymodem_Receive+0x25c>)
 1f4:	f8dd 3418 	ldr.w	r3, [sp, #1048]
 1f8:	6838      	ldr	r0, [r7, #0]
 1fa:	f103 6300 	add.w	r3, r3, #134217728	; 0x8000000
 1fe:	f503 5300 	add.w	r3, r3, #8192	; 0x2000
 202:	4298      	cmp	r0, r3
 204:	d3da      	bcc.n	1bc <Ymodem_Receive+0x1bc>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:242
                      return -2;
                    }
                    FlashDestination += 4;
                    RamSource += 4;
                  }
                  Send_Byte(ACK);
 206:	2006      	movs	r0, #6
 208:	f7ff fffe 	bl	0 <Ymodem_Receive>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:244
                }
                packets_received ++;
 20c:	f108 0801 	add.w	r8, r8, #1	; 0x1
 210:	2500      	movs	r5, #0
 212:	f04f 0901 	mov.w	r9, #1	; 0x1
 216:	e701      	b.n	1c <Ymodem_Receive+0x1c>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:250
                session_begin = 1;
              }
          }
          break;
        case 1:
          Send_Byte(CA);
 218:	2018      	movs	r0, #24
 21a:	f7ff fffe 	bl	0 <Ymodem_Receive>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:251
          Send_Byte(CA);
 21e:	2018      	movs	r0, #24
 220:	f7ff fffe 	bl	0 <Ymodem_Receive>
 224:	f06f 0002 	mvn.w	r0, #2	; 0x2
 228:	e00e      	b.n	248 <Ymodem_Receive+0x248>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:256
          return -3;
        default:
          if (session_begin > 0)
          {
            errors ++;
 22a:	3501      	adds	r5, #1
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:258
          }
          if (errors > MAX_ERRORS)
 22c:	2d05      	cmp	r5, #5
 22e:	dd07      	ble.n	240 <Ymodem_Receive+0x240>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:260
          {
            Send_Byte(CA);
 230:	2018      	movs	r0, #24
 232:	f7ff fffe 	bl	0 <Ymodem_Receive>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:261
            Send_Byte(CA);
 236:	2018      	movs	r0, #24
 238:	f7ff fffe 	bl	0 <Ymodem_Receive>
 23c:	2000      	movs	r0, #0
 23e:	e003      	b.n	248 <Ymodem_Receive+0x248>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:264
            return 0;
          }
          Send_Byte(CRC16);
 240:	2043      	movs	r0, #67
 242:	f7ff fffe 	bl	0 <Ymodem_Receive>
 246:	e6e9      	b.n	1c <Ymodem_Receive+0x1c>
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:278
    {
      break;
    }
  }
  return (int32_t)size;
}
 248:	f50d 6d84 	add.w	sp, sp, #1056	; 0x420
 24c:	e8bd 87f0 	ldmia.w	sp!, {r4, r5, r6, r7, r8, r9, sl, pc}
D:\WkPjt\MStory2.0\Mango-Z1.Firmware\Z1.Src005.AN2557.IAP.BootLoader\src/ymodem.c:254
        case 1:
          Send_Byte(CA);
          Send_Byte(CA);
          return -3;
        default:
          if (session_begin > 0)
 250:	f1b9 0f00 	cmp.w	r9, #0	; 0x0
 254:	d1e9      	bne.n	22a <Ymodem_Receive+0x22a>
 256:	e7e9      	b.n	22c <Ymodem_Receive+0x22c>
 258:	08002000 	.word	0x08002000
	...
